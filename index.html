<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>TraderSharing</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
  <style>
    body {
      margin: 0; padding: 0;
      background: #f7fbff;
      font-family: 'Segoe UI', Arial, sans-serif;
      min-height: 100vh;
      color: #222;
    }
    .main-header {
      background: #28374a;
      padding: 1.05em 1.2em 1.2em 1.2em;
      color: #fff;
      position: sticky; top: 0; z-index: 10;
      border-bottom: 1.5px solid #1a2532;
      box-shadow: 0 2px 8px #26304225;
    }
    .main-header-inner {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 1.2em;
    }
    .header-titlebox {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 0.1em;
    }
    .header-title {
      display: flex;
      align-items: center;
      font-size: 1.22em;
      font-weight: 700;
      letter-spacing: 1px;
      gap: 0.45em;
    }
    .header-title .icon {
      font-size: 1.2em;
      margin-right: 0.3em;
    }
    .header-subtitle {
      font-size: 1.04em;
      font-weight: 500;
      margin-top: 2px;
      color: #acd1ff;
      letter-spacing: 0.3px;
      display: flex;
      align-items: center;
      gap: 0.45em;
    }
    .header-desc {
      font-size: 0.95em;
      color: #b6c3d7;
      margin-top: 2px;
      font-weight: 400;
    }
    .notif-bell {
      background: #20406b;
      border-radius: 9px;
      position: relative;
      width: 38px; height: 38px;
      display: flex; align-items: center; justify-content: center;
      margin-top: 2px;
    }
    .notif-bell svg { width: 25px; height: 25px;}
    .notif-badge {
      position: absolute;
      top: 6px; right: 6px;
      background: #ff3141;
      color: #fff;
      border-radius: 50%;
      font-size: 0.85em;
      font-weight: 700;
      min-width: 18px; min-height: 18px;
      display: flex; align-items: center; justify-content: center;
      padding: 0 5px;
      border: 2px solid #20406b;
    }
    .burger-menu {
      width: 38px; height: 38px;
      display: flex; align-items: center; justify-content: center;
      margin-left: 0.8em; cursor: pointer;
      border-radius: 7px; background: #20406b;
      transition: background 0.2s;
      position: relative;
    }
    .burger-menu:hover { background: #31517a; }
    .burger-menu svg { width:28px; height:28px;}
    .dropdown-menu {
      display: none;
      flex-direction: column;
      position: absolute;
      right: 0; top: 48px;
      background: #fff;
      color: #28374a;
      min-width: 160px;
      border-radius: 8px;
      box-shadow: 0 8px 32px #22304044;
      z-index: 99;
      padding: 0.5em 0;
      animation: fadeIn 0.16s;
    }
    .dropdown-menu.show { display: flex; }
    .dropdown-menu a {
      padding: 0.85em 1.3em;
      text-decoration: none;
      color: #28374a;
      font-size: 1em;
      transition: background 0.18s;
      font-weight: 500;
    }
    .dropdown-menu a:hover { background: #eef6ff;}
    @keyframes fadeIn { from {opacity:0; transform: translateY(-7px);} to {opacity:1; transform: translateY(0);} }
    @media (max-width: 600px) {
      .main-header { padding: 0.6em 0.6em 1em 0.8em; }
      .main-header-inner { gap: 0.6em;}
      .header-title { font-size: 1.08em;}
      .header-subtitle { font-size: 0.97em;}
      .notif-bell, .burger-menu { width:33px; height:33px;}
      .notif-bell svg, .burger-menu svg { width:21px; height:21px;}
      .dropdown-menu { top:39px; min-width: 138px;}
    }

    main {
      max-width: 820px;
      margin: 0 auto;
      padding: 0 1.5em 2em 1.5em;
    }

    /* Swiper posting admin */
    #postsSection { margin: 2.2em 0 0 0; }
    .posts-swiper { width:100%; max-width:100%; }
    .posts-swiper .swiper-slide { padding: 0; background: none; border: none;}
    .post-card {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 8px #cce3fa33;
      border: 1px solid #e3e9f2;
      padding: 1.1em 1.4em 1.05em 1.4em;
      min-width: 260px;
      max-width: 340px;
      margin: 0 auto;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      gap: 0.65em;
    }
    .post-card .card-title {
      font-weight: bold;
      font-size: 1.13em;
      margin-bottom: 0.4em;
      color: #155fa0;
      display: flex;
      align-items: center;
      gap: 0.7em;
    }
    .post-card .card-image {
      max-width: 100%;
      max-height: 150px;
      border-radius: 7px;
      margin: 0.4em 0;
      object-fit: contain;
      background: #eaf4ff;
      border: 1px solid #e3e9f2;
    }
    .post-card .card-desc {
      font-size: 1.02em;
      color: #333;
      margin-bottom: 0.3em;
    }
    .post-card .card-date {
      font-size: 0.93em;
      color: #8a97ad;
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .posts-swiper .swiper-pagination-bullet { background:#155fa0; }
    .posts-swiper .swiper-button-next, .posts-swiper .swiper-button-prev { color:#155fa0; }
    .swiper-fade .swiper-slide { transition-property: opacity; }
    .no-post { color:#aaa; font-size:1em; text-align:center; padding:1.2em 0; }

    /* Analitik & Sinyal Card contoh */
    .cards-flex {
      display: flex;
      flex-wrap: wrap;
      gap: 24px;
      margin-bottom: 1.6em;
    }
    .card {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 8px #cce3fa33;
      border: 1px solid #e3e9f2;
      padding: 1.25em 1.5em 1.15em 1.5em;
      min-width: 260px;
      max-width: 340px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      gap: 0.65em;
      transition: box-shadow .2s;
      margin-bottom: 0;
    }
    .card-title {
      font-weight: bold;
      margin-bottom: 0.4em;
      font-size: 1.09em;
      display: flex;
      align-items: center;
      gap: 0.7em;
    }
    .api-url {
      font-size: 0.84em; color: #888;
      margin-left: 0.9em; word-break: break-all;
      margin-top: 2px;
    }
    .signal-list {
      list-style: none; margin: 0.5em 0 0 0; padding: 0;
      display: flex; flex-direction: column; gap: 0.2em;
    }
    .signal-list li {
      display: flex;
      justify-content: space-between;
      padding: 0.23em 0.18em;
      border-bottom: 1px solid #f2f6fb;
      font-size: 1.04em;
    }
    .signal-list li:last-child { border-bottom: none;}
    .buy { color: #1ba317; font-weight: 500;}
    .sell { color: #e82c2c; font-weight: 500;}
    .info-empty { color:#aaa; font-size:0.95em; text-align:center; margin:0.3em 0; }

    @media (max-width: 950px) {
      main { max-width: 99vw; }
      .cards-flex { flex-direction: column; gap:16px; }
      .card, .post-card { max-width: 100%; min-width: 0;}
    }
    @media (max-width: 600px) {
      main { padding: 0 4vw 2em 4vw; }
    }
  </style>
</head>
<body>
  <header class="main-header">
    <div class="main-header-inner">
      <div class="header-titlebox">
        <div class="header-title">
          <span class="icon">ðŸ“ˆ</span>
          TraderSharing
        </div>
        <div class="header-subtitle">
          <span class="icon">ðŸ“‰</span>
          Advanced Trading Analysis
        </div>
        <div class="header-desc">Real-time anomaly detection and technical analysis</div>
      </div>
      <div style="display:flex; align-items: flex-start; gap:0.4em;">
        <div class="notif-bell">
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M12 5C9.23858 5 7 7.23858 7 10V13.382L5.55365 15.2768C5.21162 15.7037 5.50504 16.3034 6.02666 16.3034H17.9733C18.495 16.3034 18.7884 15.7037 18.4464 15.2768L17 13.382V10C17 7.23858 14.7614 5 12 5Z" stroke="#acd1ff" stroke-width="2"/>
            <circle cx="12" cy="19" r="2" fill="#acd1ff"/>
          </svg>
          <span class="notif-badge">3</span>
        </div>
        <div class="burger-menu" id="burgerBtn" tabindex="0" aria-label="Menu">
          <svg viewBox="0 0 28 28" fill="none">
            <rect x="4" y="7" width="20" height="2.7" rx="1.3" fill="#fff"/>
            <rect x="4" y="13" width="20" height="2.7" rx="1.3" fill="#fff"/>
            <rect x="4" y="19" width="20" height="2.7" rx="1.3" fill="#fff"/>
          </svg>
          <nav class="dropdown-menu" id="dropdownMenu" aria-label="Menu">
            <a href="#">Menu</a>
            <a href="#">Contact</a>
            <a href="#">Broker</a>
          </nav>
        </div>
      </div>
    </div>
  </header>
  <main>
    <!-- Swiper posting admin, hanya tampil jika ada posting -->
    <section id="postsSection" style="display:none;">
      <h2 style="font-size:1.12em;font-weight:bold;color:#155fa0;margin:0 0 1em 0;letter-spacing:0.5px;">Posting Admin</h2>
      <div class="swiper posts-swiper" id="postsSwiper">
        <div class="swiper-wrapper" id="postsBox"></div>
        <div class="swiper-pagination"></div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
      </div>
    </section>

    <!-- Contoh Analitik / Sinyal -->
    <div class="cards-flex" id="sinyalCards">
      <div class="card">
        <div class="card-title">Analitik 1</div>
        <div class="info-empty">Belum tersedia.</div>
      </div>
      <div class="card">
        <div class="card-title">Analitik 2</div>
        <div class="info-empty">Belum tersedia.</div>
      </div>
    </div>
  </main>
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script type="module">
    // Burger menu logic (no alert, direct dropdown)
    const burgerBtn = document.getElementById('burgerBtn');
    const dropdownMenu = document.getElementById('dropdownMenu');
    burgerBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      dropdownMenu.classList.toggle('show');
    });
    document.addEventListener('click', function(e) {
      if (!burgerBtn.contains(e.target)) dropdownMenu.classList.remove('show');
    });

    // Supabase fetch for posting admin (slides)
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
    // Ganti dengan key dan url milik Anda
    const SUPABASE_URL = 'https://oaatowhxrefpjlwucvvg.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9hYXRvd2h4cmVmcGpsd3VjdnZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg0MzgzMDQsImV4cCI6MjA2NDAxNDMwNH0.-Qf6y5JiWVx2P6TMp9tY9g9QksTbrw4hZ1B0Ff6iU7E';
    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

    async function loadSlides() {
      const { data, error } = await supabase
        .from('slides')
        .select('*')
        .order('created_at', { ascending: false });

      const postsSection = document.getElementById('postsSection');
      const postsBox = document.getElementById('postsBox');

      if (error) {
        postsSection.style.display = 'none';
        return;
      }

      // Filter posting <=24 jam
      const now = Date.now();
      const activeSlides = (data || []).filter(slide => {
        const created = new Date(slide.created_at).getTime();
        return now - created <= 24 * 60 * 60 * 1000;
      });

      if (activeSlides.length > 0) {
        postsSection.style.display = '';
        postsBox.innerHTML = '';
        activeSlides.forEach(slide => {
          const slideDiv = document.createElement('div');
          slideDiv.className = 'swiper-slide';
          slideDiv.innerHTML = `
            <div class="post-card">
              <div class="card-title">${slide.title || ''}</div>
              ${slide.image_url ? `<img class="card-image" src="${slide.image_url}" alt="Gambar Slide">` : ''}
              <div class="card-desc">${slide.desc || ''}</div>
              <div class="card-date">${new Date(slide.created_at).toLocaleString()}</div>
            </div>
          `;
          postsBox.appendChild(slideDiv);
        });
        // Init/update Swiper
        if (!window.postsSwiper) {
          window.postsSwiper = new Swiper('.posts-swiper', {
            pagination: { el: '.swiper-pagination' },
            navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
            loop: false,
          });
        } else {
          window.postsSwiper.update();
        }
      } else {
        postsSection.style.display = 'none';
      }
    }

    loadSlides();
    setInterval(loadSlides, 5 * 60 * 1000); // auto-refresh tiap 5 menit
  </script>
</body>
</html>
